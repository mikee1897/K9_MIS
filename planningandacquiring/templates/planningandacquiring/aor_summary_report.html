{% load static %}
{% block content %} 
{% load humanize %}
{% if data %}

<div class="ui segment" id="printableArea">
    <center>
    <br><img src="{% static 'images/k9_logo.png' %}" width="150">
    <br>Philippine Coast Guard
    <br>Maritime Security Command
        <br><b>HEADQUARTERS COAST GUARD K9 FORCE</b>
    <br>Coast Guard Base Taguig
    <br>#56 ML Quezon St. New Lower Bicutan, Taguig City
        <br>Area of Responsibility Summary Report
        <br><b>{{from_date}} to {{to_date}}</b></center>
    <!--<div class="ui two column grid">-->
        <!--<div class="column">-->
            <!--<div class="ui basic segment">-->
                <!--<canvas id="myChart2" height="100"></canvas>-->
                <!--<img id="url2" />-->
            <!--</div>-->
        <!--</div>-->
        <!--<div class="column">-->
            <!--<div class="ui basic segment">-->
                <!--<canvas id="myChart" height="100"></canvas>-->
                <!--<img id="url1" />-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->

    <table class="ui small celled structured seven column table">
        <thead class="center aligned">
          <tr> 
              <th rowspan="2">Area</th>
              <th rowspan="2">Commander</th>
              <th colspan="2">K9 Request</th>
              <th colspan="3">Incidents</th>
          </tr>
          <tr>
              <th class="one wide">Big Event</th>
              <th class="one wide">Small Event</th>
              <th class="one wide">Explosive</th>
              <th class="one wide">Narcotics</th>
              <th class="one wide">Search and Rescue</th>
          </tr>
        </thead>
        <tbody>
            {% for data in data%}
            <tr class="right aligned">
                <td class="left aligned">{{data.0}}</td>
                <td>{{data.0.commander}}</td>
                <td>{{data.1|intcomma}}</td>
                <td>{{data.2|intcomma}}</td>
                <td>{{data.3|intcomma}}</td>
                <td>{{data.4|intcomma}}</td>
                <td>{{data.5|intcomma}}</td>
            </tr>            
            {%endfor%}
        </tbody>
    </table>
    <p style="page-break-before: always">
    {% if event_graph %}
{{ event_graph|safe }}
{% endif %}

        {% if incident_graph %}
{{ incident_graph|safe }}
{% endif %}


    <br>
    <br>
    <br>
    <br>
    Report generated by:
    <br>
     <br>
    {{user}}
    <br>

</div>
<center><input type="button" class="ui primary button"
onclick="printDiv('printableArea')" value="Print" /></center>

{% else %}
<div class="ui blue icon message">
    <i class="folder open icon"></i>
    <div class="content">
        <div class="header">
            NO REPORT FOR THE SELECTED DATE RANGE. :(
        </div>
    </div>
</div>

{% endif %}

<script type="text/javascript">

    function printDiv(divName) {
        var printContents = document.getElementById(divName).innerHTML;
        var originalContents = document.body.innerHTML;

        document.body.innerHTML = printContents;

        window.print();

        document.body.innerHTML = originalContents;
    }

    var datachart1 = [{{big_}},{{small_}}]
    var datachart2 = [{{edd_}},{{ndd_}},{{sar_}}]
    //CHART
    var ctx = document.getElementById('myChart').getContext('2d');
    var ctx2 = document.getElementById('myChart2').getContext('2d');
   
    var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['Big Events', 'Small Events'],
        datasets: [{
            label: 'K9 Request (Event)',
            data: datachart1,
            backgroundColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
            ],
            borderWidth: 1
        }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            },
            animation : {
                onComplete : done,
                duration:0,
            }      
        }
    });

    var myChart2 = new Chart(ctx2, {
    type: 'bar',
    data: {
        labels: ['Big Events', 'Small Events'],
        datasets: [{
            label: 'K9 Request (Event)',
            data: datachart1,
            backgroundColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
            ],
            borderWidth: 1
        }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            },
            animation : {
                // onComplete : done,
                duration:0,
            }      
        }
    });

    function done(){
        const canvas = document.getElementById('myChart')
        var url1=myChart.toBase64Image();
        document.getElementById("url1").src=url1;
        canvas.style.display = 'none'
    }

</script>
 {% endblock %}